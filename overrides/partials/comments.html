<div class="giscus"></div>
<script src="https://giscus.app/client.js"
        data-repo="Vick-wan/Notes"
        data-repo-id="R_kgDOPeOgTA"
        data-category="General"
        data-category-id="DIC_kwDOPeOgTM4CuQiU"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>

<script>
  // 监听页面的颜色模式切换
  document.addEventListener("DOMContentLoaded", function () {
    const giscusFrame = () => document.querySelector("iframe.giscus-frame");

    // 监听 mkdocs-material 的颜色模式切换
    const callback = (mutationList) => {
      for (const mutation of mutationList) {
        if (mutation.type === "attributes" && mutation.attributeName === "data-md-color-scheme") {
          const theme = document.documentElement.getAttribute("data-md-color-scheme") === "slate"
            ? "dark"
            : "light";

          giscusFrame()?.contentWindow.postMessage(
            { giscus: { setConfig: { theme: theme } } },
            "https://giscus.app"
          );
        }
      }
    };

    const observer = new MutationObserver(callback);
    observer.observe(document.documentElement, { attributes: true });
  });
</script>